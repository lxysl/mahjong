# 中国麻将基础规则（本地训练版）

本文是用于 AI 训练环境的基础规则定义，按当前需求固定，不再沿用竞赛麻将的最低分门槛与分层扩展描述。

## 1. 牌集与玩家

- 玩家数固定为 4 人。
- 座位顺序按逆时针定义。
- 仅使用 136 张牌，不使用花牌。
- 136 张构成：
  - 序数牌：万、筒、索，1-9，各 4 张，共 108 张。
  - 字牌：东南西北中发白，各 4 张，共 28 张。

## 2. 开局与发牌

- 洗牌、砌墙后发牌：
  - 庄家 14 张；
  - 其余玩家各 13 张。
- 所有人完成起手牌后，从待摸牌墙的下一张翻开 1 张作为“赖子指示牌”，该牌立即弃置，不再参与后续摸打。
- 依据赖子指示牌计算本局赖子牌（见第 3 节）。

## 3. 赖子规则

- 赖子牌可当任意牌使用。
- 赖子计算方式：
  - 若翻出序数牌：赖子为同花色“下一点”，按 1-9 循环。
  - 示例：翻出五万，赖子是六万；翻出九饼，赖子是一饼。
  - 若翻出字牌：按 `东 -> 南 -> 西 -> 北 -> 中 -> 发 -> 白 -> 东` 顺序取下一张。
  - 示例：翻出北风，赖子是红中；翻出白板，赖子是东风。

## 4. 回合流程

每个行动轮按以下顺序进行：

1. 当前玩家摸牌（若由吃/碰/杠取得出牌权，则按动作规则处理）。
2. 玩家可执行胡牌、杠牌或打牌。
3. 打出弃牌后，其他玩家进入响应窗口。
4. 若无人响应，轮到下家继续。

## 5. 动作规则

## 5.1 吃

- 允许吃上家弃牌。
- 吃必须组成同花色连续三张。
- 吃牌后立即打出 1 张牌。

## 5.2 碰

- 任意其他玩家可碰当前弃牌。
- 需手中已有同牌 2 张。
- 碰后立即打出 1 张牌。

## 5.3 杠

- 明杠：他家打出一张牌，玩家手中有同牌 3 张，可直接杠。
- 暗杠：玩家手中有同牌 4 张，可直接杠。
- 补杠（加杠）：仅允许“先碰后自摸到第 4 张”时补杠；他人打出同张不算补杠条件。
- 任何开杠后，必须从杠尾末端补 1 张牌。
- 杠上开花：补牌后胡牌，按“同时满足暗杠与胡牌”处理（见第 8 节奖励规则）。
- 杠上开花属于自摸胡。

## 5.4 胡牌响应与一炮多响

- 不启用一炮多响。
- 当同一弃牌可被多家胡牌时，按座位顺序判定胡牌权：从出牌者下家开始，按行牌方向依次检查，首个满足且声明胡牌者生效，其余无效。

## 6. 胡牌类型与合法性

## 6.1 标准胡牌

- 基础结构：`4 组面子 + 1 对将`。
- 将牌限制：将牌只能是点数为 2、5、8 的序数牌（万/筒/索），字牌不能作将。
- 不设置竞赛规则最低门槛分数，满足结构即可胡。

## 6.2 特殊胡型（启用）

当前启用特殊胡型，至少包括：

- 七对
- 十三幺
- 全不靠
- 组合龙

注：特殊胡型按其自身牌型判定，不强制使用“2/5/8 将”约束。

## 7. 流局与庄家

- 牌墙摸尽且无人胡牌则流局（荒牌）。
- 荒牌后默认庄家轮到下一家。
- 在训练和实际使用中，可不启用自动轮庄，由外部手动指定下一局庄家。

## 8. 奖励（Reward）规则

以下奖励按可叠加处理：

- 胡牌者：
  - 点胡（接炮）`+1`
  - 自摸 `+2`（与点胡互斥，二选一）
- 杠牌奖励：
  - 明杠每次 `+0.2`
  - 暗杠每次 `+0.4`
  - 杠上开花按“暗杠 + 胡牌”同时计分（即在胡牌分之外，额外按一次暗杠计 `+0.4`）
- 稠密增量奖励（按手牌进度）：
  - 首次进入听牌（从“未听牌 -> 听牌”）`+0.05`
  - 听牌可胡张数变化奖励：每增加 1 张 `+0.005`，每减少 1 张 `-0.005`
  - 单步可胡张数变化奖励裁剪到 `[-0.05, +0.05]`
- 输牌者：
  - 每名输家 `-1`

建议实现口径：

- 过程型奖励（杠牌 + 手牌进度增量）在动作发生时即时发放。
- 终局奖励（胡牌与输家惩罚）在该手结束时统一结算。
